

# General Menu
* [Introduction](/README.md)
* [Pipeline overview](/docs/pipeline_overview.md)
* [Usage](/docs/usage.md)
* [Output](/docs/output.md)


# Pipeline Overview Menu

[ Add the poster of the pipeline that I made. Maybe make it more fancy by putting it in Inkscape]

The pipeline’s input are raw fastq-files and provide detailed plots and tables. ATAC-Seq data is processed following Harvard’s ATAC-seq Guidelines (the original version from 2017; link: https://informatics.fas.harvard.edu/atac-seq-guidelines-old-version.html). As the pipeline was originally developed to analyze ATAC-Seq data, it contains a plethora of quality controls for checking the quality of the ATAC-Seq data. Now, though, the pipeline can be run using only mRNA-Seq data. MultiQC reports are provided for both kind of data.
For ATAC-Seq, reads are merged, trimmed and aligned to the genome via bowtie2 (ref). Aligned reads are filtered (low quality, duplicates, mitochondrial), shifted (atac shift (ref)) and extended to XX bp. Narrow peaks are then called using Macs2 (ref). These are further split, filtered (blacklist, gDNA) and annotated via CHIPseeker (ref). Finally, Differentially Accessible Regions are determined using DiffBind (ref).
For mRNA seq, transcripts are quantified using Kallisto (ref), and Differential Gene Expression Analysis is carried via the sleuth R package (ref).
Differential Abundance (DA) analysis refers to both Differentially Accessibility Analysis and Differential Gene Expression Analysis. Standardized outputs are produced for all DA results. This include Volcano plots and PCA plots, and DA results tables. DA results are subsequently filtered with user defined filters (False Discovery Rate, peak annotation, Fold Change). Split and filtered DA results are saved as tables.
Split and filtered DA results are then used as input for various enrichment analysis. For both ATAC-Seq and mRNA-Seq genes (DA peaks’ closest gene and DA genes) and genomic regions (DA peaks and DA genes’ promoter) are exported. Genes are used for ontologies and pathway enrichment analysis. Genomic regions are used for chromatin state, Transcription Factor known motifs and ENCODE CHIP enrichment analysis. Additionally, self-overlap enrichment analysis of genes and peaks is performed. Results are saved as tables, and displayed via Venn Diagrams, Barplots and Heatmaps.

For more details see the publication (manuscript under preparation).


A detailed view of the pipeline structure can be found on [Cactus' Directed Acyclic Graph](/docs/images/dag.svg).

[![](https://kroki.io/mermaid/svg/eNqVWEtv2zgQvu-vyNE9dGE9qMdlgdTbAgu0RZvkFhQCLdM2N3pVouN0kR-_HJJDkZLs7BYI0KG-Gc4Mh8NvvK_ac3mkvbh5-PO3G_mvW69WmyNtGlb9zupO_Hr3Tq8Hq9UN_j-8gIkcTHwBQxxMcgGTjuv7vq1xOVs91rT7YaTck4L16lH0tBm6dmB2MfAxoS9GvhivHnkjWiu7ngaJK1zwL_AdDHwPwyUPQ9_D0PcwlB4KR4z9r2TJYLJ6PPTtqXs4ddW4mq4ey2PLy3Ele7x9uN0URc36A28ORc_obvhhPvqeR9Lzmr9YMTCqoud1Dbp0RzvR9qgehQagbBZ7OoifZbFl-7ZnVgmx0RKW7gXrZ9DYQGnFD03NGlGcuTgW2_YsOAsRRQxqzytpBNyTNV78PEkt8csLM0owB7R_AuBO5oyXVDCLSK13dfu8DMFEltK04G1TtPuip-diyw9nfpBB0PLJgvOl04n9_MayJsq2qlgp7FLo12YsC2NfUSFYY5dkceiQ7QqZ20m8g41TX8xAoZHR2ZXcKXuyxkjbvmeVDnbLxJmx5mLEJFiKmIRexCRaBMU-iEzPouailVXd7HpOK-9kiXtdCR5iV7Wi4M3AelEM_B9W7Pgga2x7gkhQM1t0JfdcSTATW1o_tB_YrqCN_BO0vD_yvTCmErdlJngn2Is8tJ3M2w5vRMfoU1HSqhpLPXE7aYJ1P1Bx6nXay1P_zBBMllxOEt_l1LVoa1bvqlzA3CU5bicrXQj4PJy2HiRdT49iW8kzr2Q6ZVg9O0gXLVYWwFZ2qfKIrqThbCWCwqu3vLHup36vS2eHz5vuJGQpNqJvK9-7ZFrGqRt8mtl01p2KXvUT5bhqQW1fDEKmeRC8tDZzr03B9yIo9gxOhA0Fa3peHqElGXy2nuPDouIy7v6X9FruzF5kP0J4MIdHkHblo2ma6CHqhEs6Y2_UqhMdmei_W26bRhZPZDKRk4mcTmSbS5uwQlanl1DcOp91oxyTdKDiqFv123byYF6eoxIcXn2qBP9ZIj6ctcocntX2s1SxK_EcRGYg-1zABt83uAG2F0kIWvBEFeeOP_OdfHO8yswzpw7zKYFZzxIUrN0Wsr55__6P1017asRQCLqtZOEZGvIqsebpVqBPbV9TnZwZMDKtXQE_vnRtr3Ft8fGlZJWDJKYhABJeKXMVtJiZY9VSbmLSUrBG_40cIB8zcoiEzMgRMjIjx0jJlJNf7r7eOpdTcwQIObkGe4LeNogWgASJm7GfIWEzco6MTcvhGimbkTG5xv8wRLpm5Aj5mnJElcOCv1HowoDPIa8zMkFiZ-QEOZ2RU2RzS9sYIvcK3O4aDlkVAHMkg9eAAbiOGTEZQjlaX9MMQTNA1qiQD6aTXcxRtAgfkbbBATh-A4wdVIeboSvmksg9v4MTcAWGKT8dW8n3zSu0EeSrS7o-X52qope6TD_QWods-enn79pliIgsYp0g0gx5roeYU1iwliDR9bALZBbAKXJeH2yJHWCyZcwVRgZ9BIOalVnZPrOeHphbwEW32yt_ck_rgyaXAHT45yvQZeTWfp-KzeUlIdJq8x1lXQXbs5oi2pPwKQVYjpaQc1iKpNxsECMjNzJBPm7kBMn4VQfg2sUZEnWjivK1nIAiwSSopLyC8U4-ss4X4tzcO3UY3za3S-dAgksKG7Xnok6E7N8_A2IaJomR-E9kkzKSI-f36gwIvHlfgcQPHoGHbdNFNSDmxQDMXF-hBFOQzJKDBtJprH-pHe9haliKN8PpYeK_qckkwcFBOyabFFjRs4Diz7r51LQcoGkmoYe_sw1tx_d7SZN3gAlwsnAwW21ZPv4KLucTxY7Axyx9G--OIrBF9rbKdCgBtRinmGl-7Zd4zO_9aGADBpbymyAVIZN86hP8MqId-pJgwPqyfAMihq-CpmVuqDlOPxOwnWx0l6NgOUUqtHbA53bEAibwMHeyjXbWKFJFOSbJWi7u4JVIcV7SIabJRA5xejJydEE2VyqNcZByfBTwG8X4y8nYw1KCc9YkfNvah46VfM9LHO9eHReT_6pUQG9KMdLMf-OgThdGJCjd9RWNhSEMNsmvqMAzJU-jLzU2Ix7269YOHh3l_TgRqluEMes6-TTffDJAgk6EQ6HS-TwL8YqKZjb37iw3o0FZiBOhBtuxcRwGvQ1AJcaB0LB5lE0DxpRk5sJh2JmhothMMt0o71VaZR4k6VHu43SQOZ-nA51yyo5-oJXjqGiGijXOifYM1ZSrgsHpD65OgKPhHGeGQUAlOBAa6xFOg0bG7yYFOcFBcPLdvA36CkOR2Lp3xz75VEEm8uxNLTP0qV8i4AIMWhFHKjtT2aFq_X9MwY2Tc-Rv_wLzhD-q)

# Directed Acyclic Graph

[![](https://mermaid.ink/img/pako:eNqVWNtu2zgQ_ZXATy7QLqy7lIcFUrcFFmiLbZK3pBBoiba5kURVouNkm_77ckRqJFKymy0QoBqdIWeGw9E5_rnIeE4Xl4ttwY_ZnjTi4vbDfXUh_9Wr5XK9J1VFiz9oWYvnN2_0C2e5vMAH9xTKG6P8U6hgjApPoaLhxbbhJdrj5V1J6u_9Y2I-OqvlnWhI1da8pYPVsVCu9exZz_7yjlWCDwYjZic0nk5F6lihOlas7mysrhWra8XqyljF-Nm33gezq4bLu13DD_XtoS5G5mh5l-05y0am-O7q9mqdpiVtdqzapQ0lefu9f2vl4MkcSvY0PDvaWzSsLMGd5KQWvMEVPFcjunXTLWnFjyzd0C1vKHoh2JsDk62gzRTraywp2K4qaSXSIxP7dMOPglEXYYGGbVkhl4EQ5T1Ifxykm3g2s_XCvhakeQBkLqvHMiLoAIkwwpI_nsD0Jc3k6oLxKuXbtCHHdMN2R7aTmZDsYUAns0flW5X2ZZ9kvChoJgaba_WtL5tlWxAhaDXYZMOo3AdTMLNWaJ60H1nPMfhUMtHBlIzvRbDqs-ZNQwuV-IaKI6XV6ewDZzb7wDWzD7x5mG_BAvt0Sia47PgqbxgpzNMOjGsd9AdbF1ykrGppI9KW_UvTnLWy9zYHSAh94_l4EjOesK_JhpS3_D3NU1LJP0Gymz3bin610Bi3YX9j6JM8x1zWMO_vS03JQ5qRohjdg9CYwmF_K1oiDo06hOzQPFKEB7ORh6EVeWSsih2t9u4CwUKGSb-nvAlCwPv2sDEx0co-mU0h-6CQtZXpNXQnAx3Asik2cqZle4wncqcmDzqy3LBqSCOypmM0aQhW1Qche7QSDS-sGMNJi0dGGaIYi1vWXR262dMl0M0r3qStkEVvBcuGZRNjqAEgddIthQOibUqrhmV7mF-9Q7yaOrhpwWT-zbMMXe5Nn-TwQrwzxXtwBF2Yesr2QaKTO-c0zFLlazvJkv_D2TBcYt82BLYhtA2RbcCqYulS2bVGaTGAZDq5kr5cOyL2asK_YqXEmTbt4AUnWR4KwX5k6OBOZ2sCH2f-WToNJn8GFkxh-KmBXb6tcZd-DEmCwSGermVz9shy-cUy-zWJx82ZTKjRalorZ2WMmtXFu3d_vqz5oRJtKsimkP2ouc2LBPckoEN94k1JVKEmSK__InTIj081bxSQpx-fMlqMoEE_NAAKn7n-lqjnuD9o9Zj0yalHZ4V5aIODlE8bXOR82uAh6dMGH1lfF-2X669Xo_urOAdkH57FPcAkbAUHZIDUUG8RIyXUhgQ5oTK4KySF2oDF1om4LhJCbfCQEXbxdG0yE7fnGjhgjEgdtSFA7qgNIdJGbYiQMM7tpaniC7DHs8CeswEyQcJ5DulABlgcXS00eKtzvi74OshMO-itnn0nq-XN4wcojkRA-79D91NXJR1jNPoOyW2_QRxwQVqbBQ9T59v6BQYOsuI5Z5MV274YqGre96RUeSMJ_vxNRQ1ZBfPgUSJRjHTagEyJMqwXIp82wDOUGdARUmsTjZQRQPEJ0BmeB8MGM5s0XcYfaUN2dNzQaZ1vu5AS0-29Yq6AHJHbFyDlSOKtcebrex24yN81Ag2qJTbHTrbwgzCpCazuzUKnuAjpv97DR-6vDQEyf20IkfafjQKuox-jJNDOaDhXHnANsBxdfV5g_Vp-pcevgtGdvu6O5u_11dypBM5Jj3W37ayTh0LDOpBAz9XAR41hG3T1ggTlhdF8oBT0BxrUQmsoBdg7mvcD_p-2IADU5QqxFOGkSrhEZOf8V7fpDSiUubxjVCp2ErpVwxBFiopOzjFYSKmOjqGr8VSSrIXRGrqmwzUOvZxtt5KG5wByUMWMQBu1tuQPHV6qoY5sQaBx9AqHse6BTeJX-NgCCPx81Ex2oYdX_lDom2GJNSwxV-gQCU1g11Wd5pcBP6JBIaat7tDfQOz6L4iieeOEE5RaFhpVlBqFBNaOkFOtRugjH8AAckzQtRy3NS7bs08pymR3p9fwSYlQnalEo9A2uCjWtME7adB3LfJRuI1CFfC7yfCLzjDpogB1nVUH_BC0Nc3YlmW9pnwZBxq-1iuF6RVhxrH5XYTWndFj0M2rcy4zmg-2Sc75wIdNHkyTKXAcmOCvG5Q3NWHNoEG7u4WJq7b5NN3f0qzg5KEM7Zw-T_I856N40c1YPE5YVOyiBlVoVKqD_DS2AB8fJagWCmjQUxorE-uLiNnHmtXiqInVML3pCizrIWlTlwWKj3j03haQXWgoNcEtQXGqRcsKlSkeaKevu6R6uQlXykExOgVq-QmwECWo3sBD_akNiNDFSAKUnjZCf0jUBYe2wdsw1pny0wYlSeLfu2mN2f0cAteiVZ4o3VC7DeJt9X8Wg6sodet9tXi7kMO3JCxfXC5-wmL3C3kMJb1fXMr_5nRLZM3uF_fVLwk91Llc-2Mu70-zuNySoqVvF-Qg-M1zlaFBoT4wsmtIqa2__gNFowfI)](https://mermaid-js.github.io/mermaid-live-editor/edit#pako:eNqVWNtu2zgQ_ZXATy7QLqy7lIcFUrcFFmiLbZK3pBBoiba5kURVouNkm_77ckRqJFKymy0QoBqdIWeGw9E5_rnIeE4Xl4ttwY_ZnjTi4vbDfXUh_9Wr5XK9J1VFiz9oWYvnN2_0C2e5vMAH9xTKG6P8U6hgjApPoaLhxbbhJdrj5V1J6u_9Y2I-OqvlnWhI1da8pYPVsVCu9exZz_7yjlWCDwYjZic0nk5F6lihOlas7mysrhWra8XqyljF-Nm33gezq4bLu13DD_XtoS5G5mh5l-05y0am-O7q9mqdpiVtdqzapQ0lefu9f2vl4MkcSvY0PDvaWzSsLMGd5KQWvMEVPFcjunXTLWnFjyzd0C1vKHoh2JsDk62gzRTraywp2K4qaSXSIxP7dMOPglEXYYGGbVkhl4EQ5T1Ifxykm3g2s_XCvhakeQBkLqvHMiLoAIkwwpI_nsD0Jc3k6oLxKuXbtCHHdMN2R7aTmZDsYUAns0flW5X2ZZ9kvChoJgaba_WtL5tlWxAhaDXYZMOo3AdTMLNWaJ60H1nPMfhUMtHBlIzvRbDqs-ZNQwuV-IaKI6XV6ewDZzb7wDWzD7x5mG_BAvt0Sia47PgqbxgpzNMOjGsd9AdbF1ykrGppI9KW_UvTnLWy9zYHSAh94_l4EjOesK_JhpS3_D3NU1LJP0Gymz3bin610Bi3YX9j6JM8x1zWMO_vS03JQ5qRohjdg9CYwmF_K1oiDo06hOzQPFKEB7ORh6EVeWSsih2t9u4CwUKGSb-nvAlCwPv2sDEx0co-mU0h-6CQtZXpNXQnAx3Asik2cqZle4wncqcmDzqy3LBqSCOypmM0aQhW1Qche7QSDS-sGMNJi0dGGaIYi1vWXR262dMl0M0r3qStkEVvBcuGZRNjqAEgddIthQOibUqrhmV7mF-9Q7yaOrhpwWT-zbMMXe5Nn-TwQrwzxXtwBF2Yesr2QaKTO-c0zFLlazvJkv_D2TBcYt82BLYhtA2RbcCqYulS2bVGaTGAZDq5kr5cOyL2asK_YqXEmTbt4AUnWR4KwX5k6OBOZ2sCH2f-WToNJn8GFkxh-KmBXb6tcZd-DEmCwSGermVz9shy-cUy-zWJx82ZTKjRalorZ2WMmtXFu3d_vqz5oRJtKsimkP2ouc2LBPckoEN94k1JVKEmSK__InTIj081bxSQpx-fMlqMoEE_NAAKn7n-lqjnuD9o9Zj0yalHZ4V5aIODlE8bXOR82uAh6dMGH1lfF-2X669Xo_urOAdkH57FPcAkbAUHZIDUUG8RIyXUhgQ5oTK4KySF2oDF1om4LhJCbfCQEXbxdG0yE7fnGjhgjEgdtSFA7qgNIdJGbYiQMM7tpaniC7DHs8CeswEyQcJ5DulABlgcXS00eKtzvi74OshMO-itnn0nq-XN4wcojkRA-79D91NXJR1jNPoOyW2_QRxwQVqbBQ9T59v6BQYOsuI5Z5MV274YqGre96RUeSMJ_vxNRQ1ZBfPgUSJRjHTagEyJMqwXIp82wDOUGdARUmsTjZQRQPEJ0BmeB8MGM5s0XcYfaUN2dNzQaZ1vu5AS0-29Yq6AHJHbFyDlSOKtcebrex24yN81Ag2qJTbHTrbwgzCpCazuzUKnuAjpv97DR-6vDQEyf20IkfafjQKuox-jJNDOaDhXHnANsBxdfV5g_Vp-pcevgtGdvu6O5u_11dypBM5Jj3W37ayTh0LDOpBAz9XAR41hG3T1ggTlhdF8oBT0BxrUQmsoBdg7mvcD_p-2IADU5QqxFOGkSrhEZOf8V7fpDSiUubxjVCp2ErpVwxBFiopOzjFYSKmOjqGr8VSSrIXRGrqmwzUOvZxtt5KG5wByUMWMQBu1tuQPHV6qoY5sQaBx9AqHse6BTeJX-NgCCPx81Ex2oYdX_lDom2GJNSwxV-gQCU1g11Wd5pcBP6JBIaat7tDfQOz6L4iieeOEE5RaFhpVlBqFBNaOkFOtRugjH8AAckzQtRy3NS7bs08pymR3p9fwSYlQnalEo9A2uCjWtME7adB3LfJRuI1CFfC7yfCLzjDpogB1nVUH_BC0Nc3YlmW9pnwZBxq-1iuF6RVhxrH5XYTWndFj0M2rcy4zmg-2Sc75wIdNHkyTKXAcmOCvG5Q3NWHNoEG7u4WJq7b5NN3f0qzg5KEM7Zw-T_I856N40c1YPE5YVOyiBlVoVKqD_DS2AB8fJagWCmjQUxorE-uLiNnHmtXiqInVML3pCizrIWlTlwWKj3j03haQXWgoNcEtQXGqRcsKlSkeaKevu6R6uQlXykExOgVq-QmwECWo3sBD_akNiNDFSAKUnjZCf0jUBYe2wdsw1pny0wYlSeLfu2mN2f0cAteiVZ4o3VC7DeJt9X8Wg6sodet9tXi7kMO3JCxfXC5-wmL3C3kMJb1fXMr_5nRLZM3uF_fVLwk91Llc-2Mu70-zuNySoqVvF-Qg-M1zlaFBoT4wsmtIqa2__gNFowfI)

